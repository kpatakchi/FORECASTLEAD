/var/spool/parastation/jobs/10135274: line 17: /p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTSEAD/bashenv-train: No such file or directory
2024-08-07 03:03:21.159226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:21.161189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:21.163970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:21.165473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:21.696276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:21.699191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:21.702099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:21.703577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:21.832224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:21.834995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:21.837596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:21.840861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:22.434916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:22.436812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:22.439992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:22.442430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:22.882158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:22.884154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:22.885812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:22.887266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:23.388900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:23.390877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:23.392360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:23.397416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:23.911711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:23.913677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:23.915240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:23.917710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:24.241175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:24.243089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:24.244749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:24.246193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file0og4377r.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filez5tw_98j.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filets423xy5.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:25.296974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:25.298776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:25.301603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:25.303925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:25.350807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:25.353478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:25.356114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:25.360899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileanip3fpd.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:25.833903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:25.836743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:25.839889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:25.842198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileh1p4snbs.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:26.042313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:26.045060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:26.049480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:26.051949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0193: task 0: Exited with exit code 1
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:26.295913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:26.297996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:26.299492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:26.301109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:26.392283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:26.394551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:26.397580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:26.399162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filez6e306pu.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb0201: task 0: Exited with exit code 1
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
srun: error: jwb0225: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:26.977051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:26.981933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:26.984755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:26.988093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filem9qwnzj0.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:27.193718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:27.195518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:27.196986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:27.198523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file1gj22unm.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb0233: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:27.447130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:27.448867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:27.450470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:27.453111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:27.536068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:27.539539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:27.541182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:27.543470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0247: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:27.953536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:27.988524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:27.955318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:27.956813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:27.959627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:27.990978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:27.993973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:27.995505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:28.221744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:28.226836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:28.229446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:28.231888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0250: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filedg2grir8.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filekbvmihw_.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:28.703230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:28.707722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:28.710291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:28.712100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0252: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filewhe2zgxc.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:29.169269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:29.172575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:29.174193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:29.177416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0253: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
srun: Step created for job 10135274
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file2md0uv8c.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:29.331467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:29.335638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:29.337278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:29.339705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileu2y1y4em.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filegcuhziya.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:30.016610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:30.020471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:30.023632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:30.025273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file0codqjjh.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1049: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:30.329403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filee_lsjx53.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1089: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:30.333436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:30.336244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:30.338881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileuynctbny.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filegh62cd0g.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1050: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:30.868916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:30.871213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:30.873448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:30.876061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1090: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileirxixbwv.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filejbempxft.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1051: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filerab2qczu.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1091: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:31.433621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:31.436944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:31.438612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:31.441937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filek1lyuqu7.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:31.926478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
srun: error: jwb1092: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:31.930543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:31.932918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:31.935750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1052: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filevzucro_8.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1053: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
srun: error: jwb1093: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileri1r1sk7.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:32.781358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:32.783794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:32.785458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:32.787654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1054: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
srun: error: jwb1094: task 0: Exited with exit code 1
srun: Job 10135274 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file_4kh0kzh.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1055: task 0: Exited with exit code 1
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:33.386319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:33.388980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:33.390632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:33.392279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file2tf5bbo4.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1095: task 0: Exited with exit code 1
srun: Job 10135274 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Step created for job 10135274
2024-08-07 03:03:33.766343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:33.769815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:33.772491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:33.774152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file00wevrgo.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1056: task 0: Exited with exit code 1
srun: error: jwb1096: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file_g0754km.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1097: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileem7tvnqd.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1098: task 0: Exited with exit code 1
srun: error: jwb1099: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_files2agxsj6.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1100: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file7tt70jhi.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1109: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filedpopqg7f.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1110: task 0: Exited with exit code 1
2024-08-07 03:03:37.832278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:37.834181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:37.835737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:37.837213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:38.109650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:38.111483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:38.113103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:38.114538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1111: task 0: Exited with exit code 1
2024-08-07 03:03:38.351625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:38.353330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:38.354953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:38.356464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1112: task 0: Exited with exit code 1
2024-08-07 03:03:39.064804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:39.066669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:39.069044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:39.070540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:39.347933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:39.349848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:39.351323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:39.352775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:39.827794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:39.831036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:39.833427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:39.835127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:40.387670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:40.390597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:40.392245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:40.393876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:40.753296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:40.755001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:40.756621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:40.759403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filembzx_bbi.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileri94_7dk.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filebcnlc3hb.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:41.716482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:41.718159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:41.719790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:41.721366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:41.811951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:41.813813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:41.815457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:41.818450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filemk52agq9.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:42.290879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:42.293477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:42.294966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:42.296438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file8_m8wwna.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:42.551259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:42.553153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:42.557259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:42.559874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0193: task 0: Exited with exit code 1
2024-08-07 03:03:42.793115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:42.794896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:42.796586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:42.798822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:42.854709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file15l9rr5b.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:42.856872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:42.858403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:42.860038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0201: task 0: Exited with exit code 1
srun: error: jwb0225: task 0: Exited with exit code 1
2024-08-07 03:03:43.416698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file9grfqjkl.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:43.419209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:43.421673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:43.423372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:43.713642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:43.715510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:43.717159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:43.718947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filebjkad67q.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb0233: task 0: Exited with exit code 1
2024-08-07 03:03:43.924795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:43.927386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:43.929031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:43.930650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:44.094362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:44.096255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:44.098685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:44.101253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0247: task 0: Exited with exit code 1
2024-08-07 03:03:44.380202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:44.381928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:44.383403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:44.386039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:44.452832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:44.454719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:44.457097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:44.460434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-07 03:03:44.621908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
srun: error: jwb0250: task 0: Exited with exit code 1
2024-08-07 03:03:44.623766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:44.625306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:44.626954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file8b1hq_78.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filezjn_kupe.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb0252: task 0: Exited with exit code 1
2024-08-07 03:03:45.230717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:45.233507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:45.234998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:45.237303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filegi5tx0a9.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb0253: task 0: Exited with exit code 1
2024-08-07 03:03:45.633215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filet6od1w09.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:45.635903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:45.637449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:45.640131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file8kuhtfgg.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileobzkxwy6.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:46.256287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:46.258163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:46.259621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:46.261213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filelzq15q98.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1049: task 0: Exited with exit code 1
srun: error: jwb1089: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileg4djd_f_.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:46.842806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:46.845840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:46.848529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:46.850188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileailfa18a.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1050: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file0uvfucs3.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:47.253339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:47.255314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:47.258266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:47.260770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1090: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filewq0ogcw4.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file3zzy1602.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1051: task 0: Exited with exit code 1
srun: error: jwb1091: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileab7d61z7.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:47.849452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:47.851463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:47.852998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:47.855214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1092: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file2n0hc7p5.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
2024-08-07 03:03:48.507484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:48.509271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:48.511855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:48.513499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1052: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filel23y0uix.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1053: task 0: Exited with exit code 1
srun: error: jwb1093: task 0: Exited with exit code 1
2024-08-07 03:03:48.978133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:48.981147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:48.982733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:48.984525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb1054: task 0: Exited with exit code 1
srun: error: jwb1094: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_file1_bs3dli.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1055: task 0: Exited with exit code 1
2024-08-07 03:03:49.571143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:49.574034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:49.575697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:49.580831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filewnsqamqy.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1095: task 0: Exited with exit code 1
2024-08-07 03:03:50.192361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:50.194142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:50.197038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:50.198663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileivjcs171.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1056: task 0: Exited with exit code 1
2024-08-07 03:03:50.711903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-07 03:03:50.713720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-07 03:03:50.715239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-07 03:03:50.717611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileggncrb0f.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1096: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filefq_j58u3.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1097: task 0: Exited with exit code 1
srun: error: jwb1098: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filegidcghmw.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filea9u0m33h.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1099: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_fileywwekg3n.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1100: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 97, in <module>
    model = func_train.UNET(xpixels, ypixels, n_channels, Filters, dropout, unet_type)
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/func_train.py", line 25, in UNET
    model = models.transunet_2d((n_lat, n_lon, n_channels), filter_num=[ifn, ifn*2, ifn*4, ifn*8], n_labels=1, stack_num_down=2,
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 340, in transunet_2d
    X = transunet_2d_base(IN, filter_num, stack_num_down=stack_num_down, stack_num_up=stack_num_up, 
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/_model_transunet_2d.py", line 231, in transunet_2d_base
    X = patch_embedding(num_patches, embed_dim)(X)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/tmp/__autograph_generated_filec0047fq_.py", line 12, in tf__call
    embed = ag__.converted_call(ag__.ld(self).proj, (ag__.ld(patch),), None, fscope) + ag__.converted_call(ag__.ld(self).pos_embed, (ag__.ld(pos),), None, fscope)
ValueError: Exception encountered when calling layer "patch_embedding" (type patch_embedding).

in user code:

    File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/keras_unet_collection/transformer_layers.py", line 116, in call  *
        embed = self.proj(patch) + self.pos_embed(pos)

    ValueError: Dimensions must be equal, but are 256 and 512 for '{{node patch_embedding/add}} = AddV2[T=DT_FLOAT](patch_embedding/dense/BiasAdd, patch_embedding/embedding/embedding_lookup/Identity_1)' with input shapes: [?,256,768], [512,768].


Call arguments received by layer "patch_embedding" (type patch_embedding):
  • patch=tf.Tensor(shape=(None, 256, 1024), dtype=float32)
srun: error: jwb1109: task 0: Exited with exit code 1
srun: error: jwb1110: task 0: Exited with exit code 1
srun: error: jwb1111: task 0: Exited with exit code 1
srun: error: jwb1112: task 0: Exited with exit code 1
