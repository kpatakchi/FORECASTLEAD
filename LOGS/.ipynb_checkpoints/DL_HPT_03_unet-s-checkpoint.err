2024-08-24 13:12:48.278749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:12:48.281168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:12:48.282692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:12:48.284793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:12:51.348931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:12:51.352377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:12:51.354971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:12:51.356675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:12:55.188624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:12:55.191758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:12:55.193407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:12:55.195096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:12:58.996785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:12:59.000790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:12:59.003647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:12:59.006793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:04.876290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:04.879053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:04.881833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:04.883388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:09.283980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:09.286049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:09.288691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:09.290358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:14.776610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:14.779358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:14.781037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:14.782585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:16.601785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:16.603610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:16.605241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:16.606849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:21.183812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:21.185843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:21.188389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:21.190085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:23.372961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:23.374745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:23.376398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:23.378079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:28.427838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:28.430651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:28.432164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:28.434726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:31.475802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:31.477762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:31.479476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:31.482121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:33.393023: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:13:33.393082: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:13:33.393101: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:13:33.393114: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393129: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:13:33.393141: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393154: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393168: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393181: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393194: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393207: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393221: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393234: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393247: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393261: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393274: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393288: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393300: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393314: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393326: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393340: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393353: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:33.393373: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:13:33.393391: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:13:33.393415: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:13:33.393436: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:13:33.393456: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f412000000 of size 20076822528 next 1
2024-08-24 13:13:33.393476: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f8beac0000 of size 1280 next 2
2024-08-24 13:13:33.393494: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f8beac0500 of size 2868117504 next 3
2024-08-24 13:13:33.393514: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f969a00500 of size 2868117504 next 4
2024-08-24 13:13:33.393533: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14fa14940500 of size 256 next 5
2024-08-24 13:13:33.393553: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14fa14940600 of size 256 next 6
2024-08-24 13:13:33.393574: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14fa14940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:13:33.393594: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:13:33.393615: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:13:33.393638: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:13:33.393660: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:13:33.393682: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:13:33.393705: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:13:33.393725: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:13:33.393752: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:13:33.393776: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
2024-08-24 13:13:36.717069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:36.719892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:36.722431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:36.725395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0069: task 0: Exited with exit code 1
2024-08-24 13:13:40.053923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:40.055702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:40.057256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:40.059769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:41.542587: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:13:41.542657: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:13:41.542676: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:13:41.542690: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542705: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:13:41.542717: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542730: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542743: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542757: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542770: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542784: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542797: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542811: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542824: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542838: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542851: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542865: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542879: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542894: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542906: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542921: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542933: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:41.542950: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:13:41.542964: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:13:41.542984: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:13:41.543012: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:13:41.543028: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1512ae000000 of size 20076822528 next 1
2024-08-24 13:13:41.543041: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 15175aac0000 of size 1280 next 2
2024-08-24 13:13:41.543054: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 15175aac0500 of size 2868117504 next 3
2024-08-24 13:13:41.543083: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 151805a00500 of size 2868117504 next 4
2024-08-24 13:13:41.543095: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1518b0940500 of size 256 next 5
2024-08-24 13:13:41.543108: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1518b0940600 of size 256 next 6
2024-08-24 13:13:41.543129: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 1518b0940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:13:41.543140: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:13:41.543161: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:13:41.543174: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:13:41.543196: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:13:41.543208: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:13:41.543228: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:13:41.543250: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:13:41.543274: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:13:41.543290: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
2024-08-24 13:13:43.766271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:43.768253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:43.769942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:43.772796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
2024-08-24 13:13:45.591343: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:13:45.591390: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:13:45.591408: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:13:45.591421: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591436: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:13:45.591448: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591461: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591475: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591487: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591499: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591513: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591525: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591539: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591551: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591564: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591578: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591590: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591604: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591618: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591631: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591645: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591657: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.591671: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:13:45.591687: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:13:45.591705: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:13:45.591717: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:13:45.591733: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 15289a000000 of size 20076822528 next 1
2024-08-24 13:13:45.591746: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 152d46ac0000 of size 1280 next 2
2024-08-24 13:13:45.591758: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 152d46ac0500 of size 2868117504 next 3
2024-08-24 13:13:45.591771: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 152df1a00500 of size 2868117504 next 4
2024-08-24 13:13:45.591782: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 152e9c940500 of size 256 next 5
2024-08-24 13:13:45.591794: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 152e9c940600 of size 256 next 6
2024-08-24 13:13:45.591806: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 152e9c940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:13:45.591816: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:13:45.591829: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:13:45.591843: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:13:45.591869: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:13:45.591883: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:13:45.591895: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:13:45.591907: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:13:45.591924: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:13:45.591938: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
2024-08-24 13:13:45.625700: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:13:45.625778: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:13:45.625807: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:13:45.625822: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625836: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:13:45.625850: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625864: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625877: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625889: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625904: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625916: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625930: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625944: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625956: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625970: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625983: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.625997: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.626010: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.626024: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.626036: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.626050: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.626062: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:45.626079: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:13:45.626093: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:13:45.626113: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:13:45.626126: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:13:45.626142: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 147a16000000 of size 20076822528 next 1
2024-08-24 13:13:45.626154: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 147ec2ac0000 of size 1280 next 2
2024-08-24 13:13:45.626167: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 147ec2ac0500 of size 2868117504 next 3
2024-08-24 13:13:45.626179: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 147f6da00500 of size 2868117504 next 4
2024-08-24 13:13:45.626192: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148018940500 of size 256 next 5
2024-08-24 13:13:45.626219: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148018940600 of size 256 next 6
2024-08-24 13:13:45.626241: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 148018940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:13:45.626255: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:13:45.626270: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:13:45.626296: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:13:45.626322: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:13:45.626338: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:13:45.626362: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:13:45.626376: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:13:45.626407: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:13:45.626433: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
srun: error: jwb0098: task 0: Exited with exit code 1
2024-08-24 13:13:49.344994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38364 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:03:00.0, compute capability: 8.0
2024-08-24 13:13:49.346983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 38364 MB memory:  -> device: 1, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:44:00.0, compute capability: 8.0
2024-08-24 13:13:49.349598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 38364 MB memory:  -> device: 2, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:84:00.0, compute capability: 8.0
2024-08-24 13:13:49.351202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 38364 MB memory:  -> device: 3, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:c4:00.0, compute capability: 8.0
srun: error: jwb0203: task 0: Exited with exit code 1
srun: error: jwb0100: task 0: Exited with exit code 1
2024-08-24 13:13:53.167628: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:13:53.167688: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:13:53.167706: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:13:53.167722: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167738: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:13:53.167752: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167766: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167781: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167794: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167808: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167821: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167835: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167848: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167866: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167880: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167893: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167927: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167941: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167956: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167971: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167985: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.167999: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:53.168016: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:13:53.168032: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:13:53.168053: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:13:53.168066: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:13:53.168083: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14b562000000 of size 20076822528 next 1
2024-08-24 13:13:53.168097: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14ba0eac0000 of size 1280 next 2
2024-08-24 13:13:53.168110: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14ba0eac0500 of size 2868117504 next 3
2024-08-24 13:13:53.168122: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14bab9a00500 of size 2868117504 next 4
2024-08-24 13:13:53.168136: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14bb64940500 of size 256 next 5
2024-08-24 13:13:53.168148: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14bb64940600 of size 256 next 6
2024-08-24 13:13:53.168162: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14bb64940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:13:53.168174: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:13:53.168190: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:13:53.168205: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:13:53.168219: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:13:53.168235: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:13:53.168251: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:13:53.168267: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:13:53.168287: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:13:53.168308: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
2024-08-24 13:13:54.871089: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:13:54.871153: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:13:54.871172: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:13:54.871185: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871200: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:13:54.871212: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871225: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871239: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871252: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871266: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871279: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871293: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871305: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871319: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871332: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871346: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871360: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871374: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871388: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871404: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871419: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871436: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:54.871453: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:13:54.871472: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:13:54.871495: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:13:54.871510: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:13:54.871528: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f71e000000 of size 20076822528 next 1
2024-08-24 13:13:54.871544: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14fbcaac0000 of size 1280 next 2
2024-08-24 13:13:54.871558: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14fbcaac0500 of size 2868117504 next 3
2024-08-24 13:13:54.871589: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14fc75a00500 of size 2868117504 next 4
2024-08-24 13:13:54.871603: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14fd20940500 of size 256 next 5
2024-08-24 13:13:54.871618: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14fd20940600 of size 256 next 6
2024-08-24 13:13:54.871631: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14fd20940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:13:54.871646: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:13:54.871661: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:13:54.871677: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:13:54.871692: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:13:54.871708: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:13:54.871723: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:13:54.871736: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:13:54.871755: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:13:54.871772: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
2024-08-24 13:13:57.791270: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:13:57.791333: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:13:57.791353: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:13:57.791368: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791386: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:13:57.791401: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791414: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791427: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791441: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791457: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791471: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791488: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791505: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791520: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791538: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791556: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791573: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791590: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791606: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791625: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791643: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791660: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:13:57.791679: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:13:57.791699: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:13:57.791722: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:13:57.791738: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:13:57.791756: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14a8f2000000 of size 20076822528 next 1
2024-08-24 13:13:57.791772: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14ad9eac0000 of size 1280 next 2
2024-08-24 13:13:57.791788: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14ad9eac0500 of size 2868117504 next 3
2024-08-24 13:13:57.791804: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14ae49a00500 of size 2868117504 next 4
2024-08-24 13:13:57.791820: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14aef4940500 of size 256 next 5
2024-08-24 13:13:57.791836: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14aef4940600 of size 256 next 6
2024-08-24 13:13:57.791852: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14aef4940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:13:57.791868: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:13:57.791911: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:13:57.791931: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:13:57.791947: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:13:57.791965: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:13:57.791980: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:13:57.791991: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:13:57.792005: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:13:57.792017: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
srun: error: jwb0359: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
srun: error: jwb0328: task 0: Exited with exit code 1
srun: error: jwb0453: task 0: Exited with exit code 1
2024-08-24 13:14:05.006555: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:05.006626: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:05.006644: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:05.006658: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006673: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:05.006685: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006697: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006712: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006725: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006740: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006752: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006766: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006778: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006792: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006806: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006819: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006833: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006847: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006859: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006873: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006887: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006900: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.006917: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:05.006949: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:05.006973: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:05.006988: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:05.007005: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14ef06000000 of size 20076822528 next 1
2024-08-24 13:14:05.007021: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f3b2ac0000 of size 1280 next 2
2024-08-24 13:14:05.007035: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f3b2ac0500 of size 2868117504 next 3
2024-08-24 13:14:05.007051: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f45da00500 of size 2868117504 next 4
2024-08-24 13:14:05.007064: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f508940500 of size 256 next 5
2024-08-24 13:14:05.007079: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14f508940600 of size 256 next 6
2024-08-24 13:14:05.007093: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14f508940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:05.007107: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:05.007122: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:05.007139: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:05.007153: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:05.007169: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:05.007184: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:05.007199: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:05.007218: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:05.007235: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
2024-08-24 13:14:05.284474: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:05.284536: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:05.284574: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:05.284590: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284606: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:05.284620: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284635: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284649: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284663: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284677: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284690: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284704: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284719: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284733: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284748: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284761: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284774: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284789: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284802: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284818: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284836: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284854: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:05.284876: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:05.284896: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:05.284918: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:05.284936: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:05.284956: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14caf2000000 of size 20076822528 next 1
2024-08-24 13:14:05.284973: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14cf9eac0000 of size 1280 next 2
2024-08-24 13:14:05.284988: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14cf9eac0500 of size 2868117504 next 3
2024-08-24 13:14:05.285006: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14d049a00500 of size 2868117504 next 4
2024-08-24 13:14:05.285025: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14d0f4940500 of size 256 next 5
2024-08-24 13:14:05.285039: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14d0f4940600 of size 256 next 6
2024-08-24 13:14:05.285058: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14d0f4940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:05.285074: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:05.285093: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:05.285112: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:05.285129: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:05.285146: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:05.285164: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:05.285179: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:05.285203: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:05.285221: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
2024-08-24 13:14:07.060009: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:07.060074: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:07.060093: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:07.060106: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060121: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:07.060134: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060148: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060162: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060174: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060188: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060201: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060215: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060227: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060241: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060253: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060268: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060281: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060295: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060308: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060323: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060335: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060348: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:07.060364: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:07.060378: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:07.060398: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:07.060411: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:07.060426: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 146c06000000 of size 20076822528 next 1
2024-08-24 13:14:07.060439: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1470b2ac0000 of size 1280 next 2
2024-08-24 13:14:07.060451: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1470b2ac0500 of size 2868117504 next 3
2024-08-24 13:14:07.060465: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14715da00500 of size 2868117504 next 4
2024-08-24 13:14:07.060476: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 147208940500 of size 256 next 5
2024-08-24 13:14:07.060488: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 147208940600 of size 256 next 6
2024-08-24 13:14:07.060501: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 147208940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:07.060511: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:07.060525: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:07.060538: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:07.060550: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:07.060563: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:07.060576: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:07.060588: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:07.060605: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:07.060622: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
srun: error: jwb0811: task 0: Exited with exit code 1
srun: error: jwb0808: task 0: Exited with exit code 1
srun: error: jwb0812: task 0: Exited with exit code 1
2024-08-24 13:14:14.033220: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:14.033262: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:14.033280: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:14.033305: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033320: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:14.033333: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033346: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033361: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033375: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033392: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033407: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033423: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033438: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033454: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033470: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033487: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033503: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033518: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033534: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033549: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033565: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033586: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.033612: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:14.033635: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:14.033660: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:14.033673: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:14.033693: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148816000000 of size 20076822528 next 1
2024-08-24 13:14:14.033708: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148cc2ac0000 of size 1280 next 2
2024-08-24 13:14:14.033725: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148cc2ac0500 of size 2868117504 next 3
2024-08-24 13:14:14.033739: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148d6da00500 of size 2868117504 next 4
2024-08-24 13:14:14.033757: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148e18940500 of size 256 next 5
2024-08-24 13:14:14.033770: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 148e18940600 of size 256 next 6
2024-08-24 13:14:14.033782: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 148e18940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:14.033797: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:14.033813: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:14.033830: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:14.033847: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:14.033862: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:14.033879: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:14.033892: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:14.033913: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:14.033930: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
2024-08-24 13:14:14.396832: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:14.396915: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:14.396939: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:14.396955: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.396974: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:14.396991: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397006: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397023: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397037: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397051: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397065: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397077: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397091: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397104: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397135: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397149: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397161: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397176: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397188: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397201: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397215: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397228: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:14.397244: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:14.397259: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:14.397279: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:14.397291: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:14.397307: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1449fa000000 of size 20076822528 next 1
2024-08-24 13:14:14.397319: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 144ea6ac0000 of size 1280 next 2
2024-08-24 13:14:14.397333: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 144ea6ac0500 of size 2868117504 next 3
2024-08-24 13:14:14.397345: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 144f51a00500 of size 2868117504 next 4
2024-08-24 13:14:14.397357: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 144ffc940500 of size 256 next 5
2024-08-24 13:14:14.397370: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 144ffc940600 of size 256 next 6
2024-08-24 13:14:14.397382: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 144ffc940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:14.397393: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:14.397406: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:14.397420: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:14.397446: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:14.397458: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:14.397472: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:14.397485: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:14.397502: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:14.397516: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
srun: error: jwb0821: task 0: Exited with exit code 1
srun: error: jwb0924: task 0: Exited with exit code 1
2024-08-24 13:14:24.454037: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:24.454109: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:24.454123: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:24.454132: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454143: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:24.454152: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454159: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454167: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454175: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454182: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454195: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454202: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454210: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454217: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454225: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454232: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454240: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454247: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454254: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454261: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454269: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454276: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:24.454286: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:24.454295: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:24.454308: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:24.454316: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:24.454325: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14dfaa000000 of size 20076822528 next 1
2024-08-24 13:14:24.454331: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14e456ac0000 of size 1280 next 2
2024-08-24 13:14:24.454339: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14e456ac0500 of size 2868117504 next 3
2024-08-24 13:14:24.454346: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14e501a00500 of size 2868117504 next 4
2024-08-24 13:14:24.454353: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14e5ac940500 of size 256 next 5
2024-08-24 13:14:24.454359: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14e5ac940600 of size 256 next 6
2024-08-24 13:14:24.454366: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14e5ac940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:24.454374: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:24.454381: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:24.454389: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:24.454395: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:24.454403: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:24.454411: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:24.454418: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:24.454428: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:24.454437: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
2024-08-24 13:14:25.217972: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:25.218017: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:25.218035: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:25.218048: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218063: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:25.218075: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218087: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218101: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218114: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218127: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218141: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218153: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218167: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218180: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218193: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218207: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218219: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218233: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218245: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218259: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218271: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218285: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:25.218299: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:25.218313: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:25.218335: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:25.218346: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:25.218361: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14bffe000000 of size 20076822528 next 1
2024-08-24 13:14:25.218373: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14c4aaac0000 of size 1280 next 2
2024-08-24 13:14:25.218386: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14c4aaac0500 of size 2868117504 next 3
2024-08-24 13:14:25.218398: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14c555a00500 of size 2868117504 next 4
2024-08-24 13:14:25.218409: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14c600940500 of size 256 next 5
2024-08-24 13:14:25.218421: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14c600940600 of size 256 next 6
2024-08-24 13:14:25.218434: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14c600940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:25.218445: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:25.218457: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:25.218471: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:25.218483: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:25.218495: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:25.218509: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:25.218520: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:25.218538: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:25.218553: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
2024-08-24 13:14:26.510429: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:26.510487: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:26.510505: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:26.510518: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510534: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:26.510546: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510559: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510573: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510586: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510598: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510612: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510624: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510638: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510652: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510665: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510678: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510692: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510704: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510717: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510731: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510743: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510757: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:26.510772: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:26.510788: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:26.510807: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:26.510820: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:26.510837: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14c796000000 of size 20076822528 next 1
2024-08-24 13:14:26.510850: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14cc42ac0000 of size 1280 next 2
2024-08-24 13:14:26.510863: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14cc42ac0500 of size 2868117504 next 3
2024-08-24 13:14:26.510875: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14cceda00500 of size 2868117504 next 4
2024-08-24 13:14:26.510888: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14cd98940500 of size 256 next 5
2024-08-24 13:14:26.510900: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14cd98940600 of size 256 next 6
2024-08-24 13:14:26.510912: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 14cd98940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:26.510923: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:26.510936: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:26.510950: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:26.510962: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:26.510975: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:26.510988: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:26.510999: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:26.511017: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:26.511031: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
srun: error: jwb0940: task 0: Exited with exit code 1
srun: error: jwb0949: task 0: Exited with exit code 1
srun: error: jwb1023: task 0: Exited with exit code 1
2024-08-24 13:14:38.816482: W tensorflow/tsl/framework/bfc_allocator.cc:479] Allocator (GPU_0_bfc) ran out of memory trying to allocate 18.70GiB (rounded to 20074987520)requested by op _EagerConst
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2024-08-24 13:14:38.816539: I tensorflow/tsl/framework/bfc_allocator.cc:1034] BFCAllocator dump for GPU_0_bfc
2024-08-24 13:14:38.816562: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (256): 	Total Chunks: 2, Chunks in use: 2. 512B allocated for chunks. 512B in use in bin. 9B client-requested in use in bin.
2024-08-24 13:14:38.816577: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816595: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2024-08-24 13:14:38.816611: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816625: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816641: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816655: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816669: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816682: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816694: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816708: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816721: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816734: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816748: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816760: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816774: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816786: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816810: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816823: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816841: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2024-08-24 13:14:38.816856: I tensorflow/tsl/framework/bfc_allocator.cc:1041] Bin (268435456): 	Total Chunks: 4, Chunks in use: 3. 37.46GiB allocated for chunks. 24.04GiB in use in bin. 24.04GiB client-requested in use in bin.
2024-08-24 13:14:38.816870: I tensorflow/tsl/framework/bfc_allocator.cc:1057] Bin for 18.70GiB was 256.00MiB, Chunk State: 
2024-08-24 13:14:38.816890: I tensorflow/tsl/framework/bfc_allocator.cc:1063]   Size: 13.42GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 1B | in_use: 1 | bin_num: -1
2024-08-24 13:14:38.816901: I tensorflow/tsl/framework/bfc_allocator.cc:1070] Next region of size 40227700736
2024-08-24 13:14:38.816917: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1491e2000000 of size 20076822528 next 1
2024-08-24 13:14:38.816929: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14968eac0000 of size 1280 next 2
2024-08-24 13:14:38.816944: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 14968eac0500 of size 2868117504 next 3
2024-08-24 13:14:38.816956: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 149739a00500 of size 2868117504 next 4
2024-08-24 13:14:38.816968: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1497e4940500 of size 256 next 5
2024-08-24 13:14:38.816980: I tensorflow/tsl/framework/bfc_allocator.cc:1090] InUse at 1497e4940600 of size 256 next 6
2024-08-24 13:14:38.816991: I tensorflow/tsl/framework/bfc_allocator.cc:1090] Free  at 1497e4940700 of size 14414641408 next 18446744073709551615
2024-08-24 13:14:38.817004: I tensorflow/tsl/framework/bfc_allocator.cc:1095]      Summary of in-use Chunks by size: 
2024-08-24 13:14:38.817018: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 256 totalling 512B
2024-08-24 13:14:38.817031: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 1280 totalling 1.2KiB
2024-08-24 13:14:38.817043: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 2 Chunks of size 2868117504 totalling 5.34GiB
2024-08-24 13:14:38.817055: I tensorflow/tsl/framework/bfc_allocator.cc:1098] 1 Chunks of size 20076822528 totalling 18.70GiB
2024-08-24 13:14:38.817070: I tensorflow/tsl/framework/bfc_allocator.cc:1102] Sum Total of in-use chunks: 24.04GiB
2024-08-24 13:14:38.817081: I tensorflow/tsl/framework/bfc_allocator.cc:1104] total_region_allocated_bytes_: 40227700736 memory_limit_: 40227700736 available bytes: 0 curr_region_allocation_bytes_: 80455401472
2024-08-24 13:14:38.817098: I tensorflow/tsl/framework/bfc_allocator.cc:1110] Stats: 
Limit:                     40227700736
InUse:                     25813059328
MaxInUse:                  25813059328
NumAllocs:                           6
MaxAllocSize:              20076822528
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2024-08-24 13:14:38.817113: W tensorflow/tsl/framework/bfc_allocator.cc:492] *****************************************************************___________________________________
Traceback (most recent call last):
  File "/p/project1/cesmtst/patakchiyousefi1/CODES-MS3/FORECASTLEAD/DL_TRAIN.py", line 79, in <module>
    val_dataset = tf.data.Dataset.from_tensor_slices((val_x, val_y, val_m)).batch(BS)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/dataset_ops.py", line 818, in from_tensor_slices
    return from_tensor_slices_op.from_tensor_slices(tensors, name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 25, in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/ops/from_tensor_slices_op.py", line 33, in __init__
    element = structure.normalize_element(element)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/data/util/structure.py", line 130, in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/profiler/trace.py", line 183, in wrapped
    return func(*args, **kwargs)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1636, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/tensor_conversion_registry.py", line 48, in _default_conversion_function
    return constant_op.constant(value, dtype, name=name)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 267, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 279, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 304, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "/p/software/juwelsbooster/stages/2023/software/TensorFlow/2.11.0-foss-2022a-CUDA-11.7/lib/python3.10/site-packages/tensorflow/python/framework/constant_op.py", line 102, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
tensorflow.python.framework.errors_impl.InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:localhost/replica:0/task:0/device:GPU:0 in order to run _EagerConst: Dst tensor is not initialized.
srun: error: jwb1024: task 0: Exited with exit code 1
